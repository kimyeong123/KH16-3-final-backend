<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="pokemon">
	
	<!-- 등록 -->
	<select id="sequence" resultType="int">
		select pokemon_seq.nextval from dual
	</select>
	<insert id="add">
		insert into pokemon(
			pokemon_no, pokemon_name, pokemon_type, pokemon_like
		)
		values(#{pokemonNo}, #{pokemonName}, #{pokemonType}, 0)
	</insert>
	
	<!-- 전체목록 : 조회했을 때 나오는 내용물의 형태를 작성 -->
	<select id="list" resultType="PokemonDto">
		select * from pokemon order by pokemon_no asc
	</select>
	
	<!-- 상세조회 -->
	<select id="detail" resultType="PokemonDto">
		select * from pokemon where pokemon_no = #{pokemonNo}
	</select>
	
	<!-- 삭제 -->
	<delete id="delete">
		delete pokemon where pokemon_no = #{pokemonNo}
	</delete>
	
	<!-- 수정(PUT) -->
	<update id="update">
		update pokemon 
		set 
			pokemon_name=#{pokemonName}, 
			pokemon_type=#{pokemonType},
			pokemon_like=#{pokemonLike}
		where pokemon_no=#{pokemonNo}
	</update>
	
	<!-- 수정(PATCH) -->
	<update id="updateUnit">
		update pokemon
		<!-- 수정할 항목이 불확실할 경우 사용하여 mybatis가 자동으로 처리하도록 배치 --> 
		<set>
			<if test="pokemonName != null">
			pokemon_name=#{pokemonName}, 
			</if>
			<if test="pokemonType != null">
			pokemon_type=#{pokemonType},
			</if>
			<if test="pokemonLike != null">
			pokemon_like=#{pokemonLike},
			</if>
		</set>
		where pokemon_no=#{pokemonNo}
	</update>
	
	<!-- 조회(페이징 + 카운트) -->
	<select id="countByPaging" resultType="int">
		select count(*) from pokemon
	</select>
	<select id="listByPaging" resultType="PokemonDto">
		select * from (
			select rownum rn, TMP.* from (
				select * from pokemon order by pokemon_no desc
			)TMP
		) where rn between #{begin} and #{end}
	</select>
	
</mapper>



