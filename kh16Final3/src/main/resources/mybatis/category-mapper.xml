<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="category">

  <select id="sequence" resultType="int">
    select category_seq.nextval
    from dual
  </select>

  <insert id="insert">
    insert into category (
        category_code,
        parent_code,
        name,
        depth
    ) values (
        #{categoryCode},
        #{parentCode},
        #{name},
        #{depth}
    )
  </insert>

  <select id="list" resultType="CategoryDto">
    select
        category_code as categoryCode,
        parent_code as parentCode,
        name,
        depth
    from category
    order by category_code asc
  </select>

  <select id="listByParent" resultType="CategoryDto">
    select
        category_code as categoryCode,
        parent_code as parentCode,
        name,
        depth
    from category
    where parent_code = #{value}
    order by category_code asc
  </select>

  <select id="listTop" resultType="CategoryDto">
    select
        category_code as categoryCode,
        parent_code as parentCode,
        name,
        depth
    from category
    where parent_code is null
    order by category_code asc
  </select>

</mapper>